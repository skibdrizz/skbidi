local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local hrp = character:WaitForChild("HumanoidRootPart")

local eggName = "Egg"
local SCAN_INTERVAL = 0.5
local REACHED_DISTANCE = 5

-- Tìm egg gần nhất
local function findNearestEgg()
	local closestEgg = nil
	local shortestDistance = math.huge

	for _, obj in pairs(workspace:GetDescendants()) do
		if obj:IsA("MeshPart") and obj.Name == eggName and obj:IsDescendantOf(workspace) then
			local distance = (hrp.Position - obj.Position).Magnitude
			if distance < shortestDistance then
				closestEgg = obj
				shortestDistance = distance
			end
		end
	end

	return closestEgg
end

-- Bay tới egg
local function teleportTo(pos)
	hrp.CFrame = CFrame.new(pos + Vector3.new(0, 5, 0)) -- bay lên một chút để tránh va chạm
end

-- Reset nhân vật
local function resetCharacter()
	local humanoid = character:FindFirstChildOfClass("Humanoid")
	if humanoid then
		humanoid.Health = 0 -- chết để reset
	end
end

while true do
	local egg = findNearestEgg()

	if egg then
		print("Đã phát hiện egg, bay đến...")

		-- Bay đến egg
		teleportTo(egg.Position)

		-- Chờ nhặt egg hoặc nó biến mất
		repeat
			task.wait(0.1)
		until not egg:IsDescendantOf(workspace) or (hrp.Position - egg.Position).Magnitude <= REACHED_DISTANCE

		print("Egg đã được lấy. Reset nhân vật...")
		resetCharacter()

		-- Đợi cho đến khi respawn
		character = player.CharacterAdded:Wait()
		hrp = character:WaitForChild("HumanoidRootPart")
	else
		task.wait(SCAN_INTERVAL)
	end
end
